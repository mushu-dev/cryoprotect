(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[104],{451:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/enhanced-molecules",function(){return s(1543)}])},1543:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return EnhancedMoleculesPage}});var r=s(5893),a=s(7294);let l="https://primary-meerkat-478.convex.cloud",n=new class{async callFunction(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=Date.now();if(this.metrics.requests++,s){let s=this._generateCacheKey(e,t),r=this._getFromCache(s);if(r)return this.metrics.cacheHits++,r;this.metrics.cacheMisses++}try{let a=await fetch("".concat(this.baseUrl,"/api/").concat(s?"query":"mutation"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:e,args:t,format:"json"})});if(!a.ok)throw Error("HTTP ".concat(a.status,": ").concat(a.statusText));let l=await a.json(),n="success"===l.status?l.value:l;if(s&&n){let s=this._generateCacheKey(e,t);this._setToCache(s,n)}let c=Date.now()-r;return this._updateResponseTime(c),n}catch(e){throw console.error("Convex ".concat(s?"query":"mutation"," failed:"),e),e}}_generateCacheKey(e,t){return"".concat(e,":").concat(JSON.stringify(t))}_getFromCache(e){let t=this.cache.get(e);return t&&Date.now()-t.timestamp<this.cacheTimeout?t.data:(t&&this.cache.delete(e),null)}_setToCache(e,t){this.cache.set(e,{data:t,timestamp:Date.now()})}_updateResponseTime(e){this.metrics.avgResponseTime=(this.metrics.avgResponseTime*(this.metrics.requests-1)+e)/this.metrics.requests}clearCache(){this.cache.clear()}getMetrics(){let e=this.metrics.requests>0?(this.metrics.cacheHits/this.metrics.requests*100).toFixed(1):0;return{...this.metrics,hitRate:parseFloat(e),cacheSize:this.cache.size}}constructor(){this.baseUrl=l,this.cache=new Map,this.cacheTimeout=3e5,this.metrics={requests:0,cacheHits:0,cacheMisses:0,avgResponseTime:0}}},c={async getMolecules(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{let t=await n.callFunction("molecules:listMolecules",{limit:e.limit||20});if(!t)return{molecules:[],total:0,page:e.page||1,limit:e.limit||20};let s=await Promise.all(t.map(async e=>{try{let t=await n.callFunction("molecules:getMoleculeWithProperties",{id:e._id});return this._formatMoleculeForFrontend(t||e)}catch(t){return console.warn("Failed to get enhanced data for molecule ".concat(e._id,":"),t),this._formatMoleculeForFrontend(e)}})),r=s;if(e.search){let t=e.search.toLowerCase();r=s.filter(e=>e.name.toLowerCase().includes(t)||e.formula&&e.formula.toLowerCase().includes(t)||e.smiles&&e.smiles.toLowerCase().includes(t))}e.is_cryoprotectant&&(r=r.filter(e=>e.cryoprotectantScore&&e.cryoprotectantScore>0)),e.sort_by&&this._sortMolecules(r,e.sort_by,e.sort_order||"asc");let a=e.page||1,l=e.limit||20,c=(a-1)*l,i=r.slice(c,c+l);return{molecules:i,total:r.length,page:a,limit:l}}catch(e){throw console.error("Error fetching enhanced molecules:",e),e}},async getMolecule(e){try{let t=await n.callFunction("molecules:getMoleculeWithProperties",{id:e});if(!t)throw Error("Molecule not found");return this._formatMoleculeForFrontend(t)}catch(t){throw console.error("Error fetching enhanced molecule ".concat(e,":"),t),t}},async getMoleculeProperties(e){try{let t=await this.getMolecule(e);return{properties:t.properties||[]}}catch(t){throw console.error("Error fetching properties for molecule ".concat(e,":"),t),t}},async searchMolecules(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;try{let s=await this.getMolecules({limit:1e3}),r=e.toLowerCase(),a=s.molecules.filter(e=>e.name.toLowerCase().includes(r)||e.formula&&e.formula.toLowerCase().includes(r)||e.smiles&&e.smiles.toLowerCase().includes(r));return a.sort((e,t)=>{let s=e.name.toLowerCase().includes(r)?1:0,a=t.name.toLowerCase().includes(r)?1:0;return s!==a?a-s:(t.cryoprotectantScore||0)-(e.cryoprotectantScore||0)}),{results:a.slice(0,t)}}catch(e){throw console.error("Error searching enhanced molecules:",e),e}},async getCryoprotectantRanking(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;try{let s=await n.callFunction("molecules:listMoleculesWithScores",{category:e,limit:t});return{molecules:s.map(e=>this._formatMoleculeForFrontend(e))}}catch(e){throw console.error("Error fetching cryoprotectant ranking:",e),e}},async getQualityMetrics(){try{let e=await n.callFunction("molecules:listMolecules",{limit:1e3}),t=0,s=0,r=0,a=0;if(e){for(let l of(t=e.length,e)){let e=await n.callFunction("molecules:getMoleculeWithProperties",{id:l._id});(null==e?void 0:e.properties)&&s++,(null==e?void 0:e.scores)&&(r++,a+=e.scores.overallScore||0)}a=r>0?a/r:0}return{totalMolecules:t,moleculesWithProperties:s,moleculesWithScores:r,avgQualityScore:Math.round(100*a)/100,propertiesCompletionRate:t>0?s/t*100:0,scoresCompletionRate:t>0?r/t*100:0}}catch(e){throw console.error("Error fetching quality metrics:",e),e}},_formatMoleculeForFrontend(e){if(!e)return null;let t=e.properties||{},s=e.scores||{};return{id:e._id,name:e.name,formula:e.formula,smiles:e.canonicalSmiles,inchiKey:e.inchiKey,pubchemCid:e.pubchemCid,status:e.status,createdAt:e.createdAt,updatedAt:e.updatedAt,molecularWeight:t.molecularWeight,exactMass:t.exactMass,logP:t.logP,tpsa:t.tpsa,hbondDonors:t.hbondDonors,hbondAcceptors:t.hbondAcceptors,rotatableBonds:t.rotatableBonds,aromaticRings:t.aromaticRings,aliphaticRings:t.aliphaticRings,complexity:t.complexity,heavyAtomCount:t.heavyAtomCount,morganFingerprint:t.morganFingerprint,rdkitFingerprint:t.rdkitFingerprint,cryoprotectantScore:s.overallScore,cryoprotectantCategory:s.category,glassTempScore:s.glassTempScore,viscosityScore:s.viscosityScore,permeabilityScore:s.permeabilityScore,toxicityScore:s.toxicityScore,confidence:s.confidence,properties:{...t,calculatedAt:t.calculatedAt,calculationVersion:t.calculationVersion},cryoprotectantScores:{...s,calculatedAt:s.calculatedAt,scoringAlgorithmVersion:s.scoringAlgorithmVersion}}},_sortMolecules(e,t,s){let r="desc"===s?-1:1;e.sort((e,s)=>{let a=e[t],l=s[t];return("molecular_weight"===t?(a=e.molecularWeight,l=s.molecularWeight):"created_at"===t&&(a=new Date(e.createdAt),l=new Date(s.createdAt)),null==a&&null==l)?0:null==a?1:null==l?-1:"string"==typeof a?r*a.localeCompare(l):"number"==typeof a||a instanceof Date?r*(a-l):0})},getClientMetrics:()=>n.getMetrics(),clearCache(){n.clearCache()}};function Card(e){let{children:t,className:s="",...a}=e;return(0,r.jsx)("div",{className:"bg-white rounded-lg border shadow-sm overflow-hidden ".concat(s),...a,children:t})}function Badge(e){let{children:t,className:s="",variant:a="default",...l}=e,n={default:"bg-primary text-primary-foreground",secondary:"bg-secondary text-secondary-foreground",destructive:"bg-destructive text-destructive-foreground",outline:"text-foreground border border-input bg-background"},c="".concat("inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold transition-colors"," ").concat(n[a]||n.default," ").concat(s);return(0,r.jsx)("span",{className:c,...l,children:t})}console.log("\uD83D\uDE80 Enhanced Convex service initialized"),console.log("\uD83D\uDCE1 Connected to: ".concat(l)),c.getMolecules({limit:1}).then(()=>{console.log("✅ Enhanced Convex connection verified")}).catch(e=>{console.warn("⚠️ Enhanced Convex connection failed:",e)});let ChemicalIcon=()=>(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4",children:[(0,r.jsx)("path",{d:"M9 3 5 7l4 4"}),(0,r.jsx)("path",{d:"m15 3 4 4-4 4"}),(0,r.jsx)("path",{d:"M9 19c-4.3 0-8-1.7-8-4"}),(0,r.jsx)("path",{d:"M15 19c4.3 0 8-1.7 8-4"}),(0,r.jsx)("path",{d:"M9 11h6"})]}),ScoreIcon=()=>(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4",children:(0,r.jsx)("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})}),QualityIcon=()=>(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4",children:[(0,r.jsx)("path",{d:"M9 12l2 2 4-4"}),(0,r.jsx)("path",{d:"M21 12c-1 0-3-1-3-3s2-3 3-3 3 1 3 3-2 3-3 3"}),(0,r.jsx)("path",{d:"M3 12c1 0 3-1 3-3s-2-3-3-3-3 1-3 3 2 3 3 3"}),(0,r.jsx)("path",{d:"M3 12c0 5.657 4.343 10 10 10 5.657 0 10-4.343 10-10"})]}),getCategoryColor=e=>{switch(null==e?void 0:e.toLowerCase()){case"penetrating":return"bg-blue-100 text-blue-800 border-blue-200";case"non_penetrating":return"bg-green-100 text-green-800 border-green-200";case"sugar":return"bg-purple-100 text-purple-800 border-purple-200";case"polymer":return"bg-orange-100 text-orange-800 border-orange-200";case"alcohol":return"bg-pink-100 text-pink-800 border-pink-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},getScoreColor=e=>e>=90?"text-green-600 font-semibold":e>=80?"text-blue-600 font-semibold":e>=70?"text-yellow-600 font-semibold":e>=60?"text-orange-600 font-semibold":"text-red-600 font-semibold";function EnhancedMoleculeCard(e){let{molecule:t,onClick:s,showDetails:a=!1}=e;if(!t)return(0,r.jsx)(Card,{className:"p-4 border-dashed border-gray-300",children:(0,r.jsxs)("div",{className:"text-center text-gray-500",children:[(0,r.jsx)(ChemicalIcon,{className:"mx-auto mb-2 opacity-50"}),(0,r.jsx)("p",{children:"Molecule data unavailable"})]})});let l=["molecularWeight","logP","tpsa","exactMass","complexity"],n=l.filter(e=>null!=t[e]).length,c=Math.round(n/l.length*100);return(0,r.jsxs)(Card,{className:"p-4 hover:shadow-lg transition-all duration-200 cursor-pointer border ".concat(t.cryoprotectantScore>=80?"border-blue-200 bg-blue-50/30":"border-gray-200"),onClick:()=>{s&&s(t)},children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("h3",{className:"font-semibold text-lg text-gray-900 truncate",children:t.name}),t.formula&&(0,r.jsx)("p",{className:"text-sm text-gray-600 font-mono",children:t.formula})]}),t.cryoprotectantScore&&(0,r.jsx)("div",{className:"flex-shrink-0 ml-2",children:(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)(ScoreIcon,{}),(0,r.jsx)("span",{className:"text-lg font-bold ".concat(getScoreColor(t.cryoprotectantScore)),children:Math.round(t.cryoprotectantScore)})]})})]}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2 mb-3",children:[t.cryoprotectantCategory&&(0,r.jsx)(Badge,{variant:"outline",className:getCategoryColor(t.cryoprotectantCategory),children:t.cryoprotectantCategory.replace("_"," ")}),t.status&&(0,r.jsx)(Badge,{variant:"outline",children:t.status}),100===c&&(0,r.jsxs)(Badge,{variant:"outline",className:"bg-green-100 text-green-800 border-green-200",children:[(0,r.jsx)(QualityIcon,{className:"mr-1"}),"Complete"]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[t.molecularWeight&&(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Mol. Weight:"}),(0,r.jsxs)("span",{className:"ml-1 font-medium",children:[Math.round(100*t.molecularWeight)/100," Da"]})]}),t.logP&&(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-600",children:"LogP:"}),(0,r.jsx)("span",{className:"ml-1 font-medium",children:Math.round(100*t.logP)/100})]}),t.tpsa&&(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-600",children:"TPSA:"}),(0,r.jsxs)("span",{className:"ml-1 font-medium",children:[Math.round(100*t.tpsa)/100," Ų"]})]}),t.heavyAtomCount&&(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Heavy Atoms:"}),(0,r.jsx)("span",{className:"ml-1 font-medium",children:t.heavyAtomCount})]})]}),a&&(0,r.jsxs)("div",{className:"mt-4 pt-3 border-t border-gray-200",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-2 text-sm",children:[t.glassTempScore&&(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Glass Formation:"}),(0,r.jsxs)("span",{className:"font-medium ".concat(getScoreColor(t.glassTempScore)),children:[Math.round(t.glassTempScore),"%"]})]}),t.permeabilityScore&&(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Permeability:"}),(0,r.jsxs)("span",{className:"font-medium ".concat(getScoreColor(t.permeabilityScore)),children:[Math.round(t.permeabilityScore),"%"]})]}),t.toxicityScore&&(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Safety:"}),(0,r.jsxs)("span",{className:"font-medium ".concat(getScoreColor(t.toxicityScore)),children:[Math.round(t.toxicityScore),"%"]})]}),t.complexity&&(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Complexity:"}),(0,r.jsx)("span",{className:"font-medium",children:Math.round(100*t.complexity)/100})]}),t.exactMass&&(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Exact Mass:"}),(0,r.jsxs)("span",{className:"font-medium",children:[Math.round(1e4*t.exactMass)/1e4," Da"]})]})]}),(0,r.jsx)("div",{className:"mt-3 pt-2 border-t border-gray-100",children:(0,r.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,r.jsx)("span",{className:"text-gray-500",children:"Data Completeness:"}),(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)("div",{className:"w-16 h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,r.jsx)("div",{className:"h-full transition-all duration-300 ".concat(c>=80?"bg-green-500":c>=60?"bg-yellow-500":"bg-red-500"),style:{width:"".concat(c,"%")}})}),(0,r.jsxs)("span",{className:"font-medium text-gray-700",children:[c,"%"]})]})]})})]}),t.pubchemCid&&(0,r.jsx)("div",{className:"mt-3 pt-2 border-t border-gray-100",children:(0,r.jsxs)("span",{className:"text-xs text-gray-500",children:["PubChem CID: ",t.pubchemCid]})})]})}function EnhancedMoleculeCardSkeleton(){return(0,r.jsxs)(Card,{className:"p-4 animate-pulse",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("div",{className:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]}),(0,r.jsx)("div",{className:"w-8 h-8 bg-gray-200 rounded"})]}),(0,r.jsxs)("div",{className:"flex gap-2 mb-3",children:[(0,r.jsx)("div",{className:"h-5 bg-gray-200 rounded w-16"}),(0,r.jsx)("div",{className:"h-5 bg-gray-200 rounded w-12"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded"}),(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded"}),(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded"}),(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded"})]})]})}function Input(e){let{className:t="",type:s="text",...a}=e;return(0,r.jsx)("input",{type:s,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 ".concat(t),...a})}function Button(e){let{children:t,className:s="",variant:l="default",size:n="default",asChild:c=!1,...i}=e,o={default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},d={default:"h-10 py-2 px-4",sm:"h-9 px-3 rounded-md",lg:"h-11 px-8 rounded-md",icon:"h-10 w-10"},h="".concat("inline-flex items-center justify-center rounded-md font-medium transition-colors"," ").concat(o[l]||o.default," ").concat(d[n]||d.default," ").concat(s);if(c&&1===a.Children.count(t)){let e=a.Children.only(t);return a.cloneElement(e,{...i,className:"".concat(h," ").concat(e.props.className||"")})}return(0,r.jsx)("button",{className:h,...i,children:t})}function Select(e){let{children:t,defaultValue:s,onValueChange:a,className:l="",...n}=e;return(0,r.jsx)("select",{className:"h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 ".concat(l),defaultValue:s,onChange:e=>a&&a(e.target.value),...n,children:t})}function SelectTrigger(e){let{children:t,className:s="",...a}=e;return(0,r.jsx)("div",{className:"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background ".concat(s),...a,children:t})}function SelectValue(e){let{children:t,placeholder:s,...a}=e;return(0,r.jsx)("span",{...a,children:t||s})}function SelectContent(e){let{children:t,className:s="",...a}=e;return(0,r.jsx)("div",{className:"relative z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md animate-in fade-in-80 ".concat(s),...a,children:(0,r.jsx)("div",{className:"p-1",children:t})})}function SelectItem(e){let{children:t,value:s,className:a="",...l}=e;return(0,r.jsx)("option",{value:s,className:"".concat(a),...l,children:t})}function Pagination(e){let{className:t="",...s}=e;return(0,r.jsx)("nav",{role:"navigation","aria-label":"pagination",className:"mx-auto flex w-full justify-center ".concat(t),...s})}function PaginationContent(e){let{className:t="",...s}=e;return(0,r.jsx)("ul",{className:"flex flex-row items-center gap-1 ".concat(t),...s})}function PaginationItem(e){let{className:t="",...s}=e;return(0,r.jsx)("li",{className:t,...s})}function PaginationLink(e){let{className:t="",isActive:s=!1,children:a,onClick:l,...n}=e;return(0,r.jsx)("button",{onClick:l,"aria-current":s?"page":void 0,className:"flex h-10 w-10 items-center justify-center rounded-md border ".concat(s?"bg-primary text-primary-foreground":"bg-background text-foreground hover:bg-muted hover:text-muted-foreground"," ").concat(t),...n,children:a})}function PaginationPrevious(e){let{className:t="",onClick:s,...a}=e;return(0,r.jsx)(PaginationLink,{onClick:s,"aria-label":"Go to previous page",className:"gap-1 pl-2.5 ".concat(t),...a,children:(0,r.jsx)("span",{children:"Previous"})})}function PaginationNext(e){let{className:t="",onClick:s,...a}=e;return(0,r.jsx)(PaginationLink,{onClick:s,"aria-label":"Go to next page",className:"gap-1 pr-2.5 ".concat(t),...a,children:(0,r.jsx)("span",{children:"Next"})})}function PaginationEllipsis(e){let{className:t="",...s}=e;return(0,r.jsx)("span",{"aria-hidden":!0,className:"flex h-10 w-10 items-center justify-center ".concat(t),...s,children:(0,r.jsx)("span",{children:"..."})})}function Switch(e){let{className:t="",id:s,checked:a=!1,onCheckedChange:l,...n}=e;return(0,r.jsx)("input",{type:"checkbox",id:s,role:"switch",checked:a,onChange:e=>l&&l(e.target.checked),className:"appearance-none w-11 h-6 rounded-full bg-muted transition-colors \n        relative before:content-[''] before:inline-block before:size-5 before:rounded-full \n        before:bg-background before:shadow-sm before:transform before:translate-x-0.5 \n        before:transition-transform checked:bg-primary checked:before:translate-x-5 \n        focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring \n        focus-visible:ring-offset-2 ".concat(t),...n})}function Label(e){let{className:t="",htmlFor:s,children:a,...l}=e;return(0,r.jsx)("label",{htmlFor:s,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 ".concat(t),...l,children:a})}let SearchIcon=()=>(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4",children:[(0,r.jsx)("circle",{cx:"11",cy:"11",r:"8"}),(0,r.jsx)("path",{d:"m21 21-4.3-4.3"})]}),FilterIcon=()=>(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4 mr-2",children:(0,r.jsx)("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})}),RefreshIcon=()=>(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4",children:[(0,r.jsx)("path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"}),(0,r.jsx)("path",{d:"M21 3v5h-5"}),(0,r.jsx)("path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"}),(0,r.jsx)("path",{d:"M3 21v-5h5"})]}),MetricsIcon=()=>(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4",children:[(0,r.jsx)("path",{d:"M3 3v18h18"}),(0,r.jsx)("path",{d:"M7 12l4-4 4 4 4-4"})]});function EnhancedMoleculesList(){var e,t;let[s,l]=(0,a.useState)({page:1,limit:12,sort_by:"name",sort_order:"asc"}),[n,i]=(0,a.useState)(""),[o,d]=(0,a.useState)(!1),[h,u]=(0,a.useState)(!1),{data:m,isLoading:x,error:g,refetch:p}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[t,s]=(0,a.useState)(null),[r,l]=(0,a.useState)(!1),[n,i]=(0,a.useState)(null),o=(0,a.useCallback)(async()=>{l(!0),i(null);try{let t=await c.getMolecules(e);s(t)}catch(e){i(e),console.error("Error fetching enhanced molecules:",e)}finally{l(!1)}},[e]);return(0,a.useEffect)(()=>{o()},[o]),{data:t,isLoading:r,error:n,refetch:o}}(s),{data:f}=function(){let[e,t]=(0,a.useState)(null);return(0,a.useEffect)(()=>{let updateMetrics=()=>{let e=c.getClientMetrics();t(e)};updateMetrics();let e=setInterval(updateMetrics,3e4);return()=>clearInterval(e)},[]),{data:e}}(),j=(0,a.useCallback)(()=>{c.clearCache(),console.log("\uD83D\uDD04 Enhanced molecular data cache cleared")},[]);(0,a.useEffect)(()=>{let e=setInterval(()=>{x||(j(),p())},12e4);return()=>clearInterval(e)},[j,p,x]);let handleSearch=()=>{l(e=>({...e,search:n,page:1}))},handlePageChange=e=>{l(t=>({...t,page:e}))},handleMoleculeClick=e=>{console.log("Selected molecule:",e)},b=m?Math.ceil(m.total/m.limit):0;return(0,r.jsxs)("div",{className:"space-y-6",children:[o&&f&&(0,r.jsxs)(Card,{className:"p-4 bg-blue-50 border-blue-200",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsxs)("h4",{className:"font-semibold flex items-center",children:[(0,r.jsx)(MetricsIcon,{className:"mr-2"}),"Performance Metrics"]}),(0,r.jsx)(Button,{variant:"ghost",size:"sm",onClick:()=>d(!1),children:"\xd7"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Cache Hit Rate:"}),(0,r.jsxs)("span",{className:"ml-1 font-semibold text-green-600",children:[f.hitRate,"%"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Avg Response:"}),(0,r.jsxs)("span",{className:"ml-1 font-semibold",children:[Math.round(f.avgResponseTime),"ms"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Requests:"}),(0,r.jsx)("span",{className:"ml-1 font-semibold",children:f.requests})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Cache Size:"}),(0,r.jsx)("span",{className:"ml-1 font-semibold",children:f.cacheSize})]})]})]}),(0,r.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,r.jsxs)("div",{className:"relative flex-grow",children:[(0,r.jsx)("div",{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground",children:(0,r.jsx)(SearchIcon,{})}),(0,r.jsx)(Input,{placeholder:"Search molecules...",className:"pl-9",value:n,onChange:e=>i(e.target.value),onKeyDown:e=>{"Enter"===e.key&&handleSearch()}})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(Button,{variant:"outline",className:"w-[90px]",onClick:handleSearch,disabled:x,children:x?"...":"Search"}),(0,r.jsxs)(Select,{defaultValue:"name:asc",onValueChange:e=>{let[t,s]=e.split(":");l(e=>({...e,sort_by:t,sort_order:s}))},children:[(0,r.jsxs)(SelectTrigger,{className:"w-[165px]",children:[(0,r.jsx)(FilterIcon,{}),(0,r.jsx)(SelectValue,{placeholder:"Sort by"})]}),(0,r.jsxs)(SelectContent,{children:[(0,r.jsx)(SelectItem,{value:"name:asc",children:"Name (A-Z)"}),(0,r.jsx)(SelectItem,{value:"name:desc",children:"Name (Z-A)"}),(0,r.jsx)(SelectItem,{value:"molecular_weight:asc",children:"Weight (Low-High)"}),(0,r.jsx)(SelectItem,{value:"molecular_weight:desc",children:"Weight (High-Low)"}),(0,r.jsx)(SelectItem,{value:"cryoprotectantScore:desc",children:"Score (High-Low)"}),(0,r.jsx)(SelectItem,{value:"cryoprotectantScore:asc",children:"Score (Low-High)"}),(0,r.jsx)(SelectItem,{value:"created_at:desc",children:"Newest First"}),(0,r.jsx)(SelectItem,{value:"created_at:asc",children:"Oldest First"})]})]}),(0,r.jsx)(Button,{variant:"outline",onClick:j,disabled:x,className:"px-3",children:(0,r.jsx)(RefreshIcon,{className:x?"animate-spin":""})})]})]}),(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-6",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(Switch,{id:"cryoprotectant",checked:!!s.is_cryoprotectant,onCheckedChange:e=>{l(t=>({...t,is_cryoprotectant:e||void 0,page:1}))}}),(0,r.jsx)(Label,{htmlFor:"cryoprotectant",children:"Show cryoprotectants only"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(Switch,{id:"details",checked:h,onCheckedChange:u}),(0,r.jsx)(Label,{htmlFor:"details",children:"Show detailed properties"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(Switch,{id:"metrics",checked:o,onCheckedChange:d}),(0,r.jsx)(Label,{htmlFor:"metrics",children:"Show performance metrics"})]})]})]}),m&&(0,r.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[(0,r.jsxs)("span",{children:["Showing ",(null===(e=m.molecules)||void 0===e?void 0:e.length)||0," of ",m.total||0," molecules"]}),f&&f.hitRate>=80&&(0,r.jsx)(Badge,{variant:"outline",className:"bg-green-100 text-green-800 border-green-200",children:"\uD83D\uDE80 Fast Cache"}),x&&(0,r.jsx)(Badge,{variant:"outline",children:"\uD83D\uDD04 Updating..."})]}),x&&(0,r.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:[...Array(s.limit)].map((e,t)=>(0,r.jsx)(EnhancedMoleculeCardSkeleton,{},t))}),!!g&&(0,r.jsx)("div",{className:"text-center py-12",children:(0,r.jsxs)(Card,{className:"p-6 border-red-200 bg-red-50",children:[(0,r.jsxs)("p",{className:"text-red-600 mb-4",children:["Error loading enhanced molecules: ",g instanceof Error?g.message:"Unknown error"]}),(0,r.jsxs)("div",{className:"flex gap-2 justify-center",children:[(0,r.jsx)(Button,{variant:"outline",onClick:p,children:"Retry"}),(0,r.jsxs)(Button,{variant:"outline",onClick:j,children:[(0,r.jsx)(RefreshIcon,{className:"mr-2"}),"Refresh Cache"]})]})]})}),(null==m?void 0:null===(t=m.molecules)||void 0===t?void 0:t.length)===0&&!x&&(0,r.jsx)("div",{className:"text-center py-12",children:(0,r.jsxs)(Card,{className:"p-6",children:[(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:"No molecules found."}),(s.search||s.is_cryoprotectant)&&(0,r.jsx)(Button,{variant:"outline",onClick:()=>{l({page:1,limit:12,sort_by:"name",sort_order:"asc"}),i("")},children:"Clear Filters"})]})}),(null==m?void 0:m.molecules)&&m.molecules.length>0&&(0,r.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:m.molecules.map(e=>(0,r.jsx)(EnhancedMoleculeCard,{molecule:e,onClick:handleMoleculeClick,showDetails:h},e.id))}),m&&m.total>m.limit&&(0,r.jsx)(Pagination,{className:"mt-8",children:(0,r.jsxs)(PaginationContent,{children:[(0,r.jsx)(PaginationPrevious,{onClick:()=>handlePageChange(Math.max(1,(s.page||1)-1)),disabled:s.page<=1}),(()=>{let e=[],t=s.page||1;e.push((0,r.jsx)(PaginationItem,{children:(0,r.jsx)(PaginationLink,{onClick:()=>handlePageChange(1),isActive:1===t,children:"1"})},"first")),t>3&&e.push((0,r.jsx)(PaginationItem,{children:(0,r.jsx)(PaginationEllipsis,{})},"ellipsis-1"));for(let s=Math.max(2,t-1);s<=Math.min(b-1,t+1);s++)s<=1||s>=b||e.push((0,r.jsx)(PaginationItem,{children:(0,r.jsx)(PaginationLink,{onClick:()=>handlePageChange(s),isActive:t===s,children:s})},s));return t<b-2&&e.push((0,r.jsx)(PaginationItem,{children:(0,r.jsx)(PaginationEllipsis,{})},"ellipsis-2")),b>1&&e.push((0,r.jsx)(PaginationItem,{children:(0,r.jsx)(PaginationLink,{onClick:()=>handlePageChange(b),isActive:t===b,children:b})},"last")),e})(),(0,r.jsx)(PaginationNext,{onClick:()=>handlePageChange(Math.min(b,(s.page||1)+1)),disabled:s.page>=b})]})})]})}function QualitySummary(){let{data:e,isLoading:t}=function(){let[e,t]=(0,a.useState)(null),[s,r]=(0,a.useState)(!1),[l,n]=(0,a.useState)(null),i=(0,a.useCallback)(async()=>{r(!0),n(null);try{let e=await c.getQualityMetrics();t(e)}catch(e){n(e),console.error("Error fetching quality metrics:",e)}finally{r(!1)}},[]);return(0,a.useEffect)(()=>{i()},[i]),{data:e,isLoading:s,error:l,refetch:i}}();return t?(0,r.jsxs)(Card,{className:"p-4 animate-pulse",children:[(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/3 mb-2"}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,r.jsx)("div",{className:"h-8 bg-gray-200 rounded"}),(0,r.jsx)("div",{className:"h-8 bg-gray-200 rounded"}),(0,r.jsx)("div",{className:"h-8 bg-gray-200 rounded"})]})]}):e?(0,r.jsxs)(Card,{className:"p-4 bg-gradient-to-r from-blue-50 to-green-50 border-blue-200",children:[(0,r.jsx)("h3",{className:"font-semibold mb-3 text-gray-900",children:"Database Quality Overview"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:e.totalMolecules}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"Total Molecules"})]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:[Math.round(e.propertiesCompletionRate),"%"]}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"Properties Complete"})]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsxs)("div",{className:"text-2xl font-bold text-purple-600",children:[Math.round(e.scoresCompletionRate),"%"]}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"Scored Molecules"})]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:e.avgQualityScore}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"Avg Quality Score"})]})]}),(0,r.jsxs)("div",{className:"mt-3 flex justify-center",children:[e.avgQualityScore>=90&&(0,r.jsx)(Badge,{className:"bg-green-100 text-green-800 border-green-200",children:"\uD83C\uDFAF Excellent Quality"}),e.avgQualityScore>=80&&e.avgQualityScore<90&&(0,r.jsx)(Badge,{className:"bg-blue-100 text-blue-800 border-blue-200",children:"✅ High Quality"}),e.avgQualityScore<80&&(0,r.jsx)(Badge,{className:"bg-yellow-100 text-yellow-800 border-yellow-200",children:"⚡ Improving"})]})]}):null}function EnhancedMoleculesPage(){return(0,r.jsxs)("div",{className:"container mx-auto py-8",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold",children:"Enhanced Molecules"}),(0,r.jsx)(Badge,{className:"bg-blue-100 text-blue-800 border-blue-200",children:"\uD83D\uDE80 Real-time Convex"})]}),(0,r.jsx)("p",{className:"text-muted-foreground max-w-3xl",children:"Experience our enhanced molecular database with real-time updates, advanced cryoprotectant scoring, comprehensive molecular properties, and intelligent caching for lightning-fast performance."})]}),(0,r.jsx)("div",{className:"mb-8",children:(0,r.jsx)(QualitySummary,{})}),(0,r.jsx)("div",{className:"mb-8",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,r.jsxs)(Card,{className:"p-4 text-center",children:[(0,r.jsx)("div",{className:"text-2xl mb-2",children:"\uD83D\uDD04"}),(0,r.jsx)("h4",{className:"font-semibold mb-1",children:"Real-time Updates"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Live data synchronization"})]}),(0,r.jsxs)(Card,{className:"p-4 text-center",children:[(0,r.jsx)("div",{className:"text-2xl mb-2",children:"⚡"}),(0,r.jsx)("h4",{className:"font-semibold mb-1",children:"Smart Caching"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"5x faster performance"})]}),(0,r.jsxs)(Card,{className:"p-4 text-center",children:[(0,r.jsx)("div",{className:"text-2xl mb-2",children:"\uD83E\uDDEA"}),(0,r.jsx)("h4",{className:"font-semibold mb-1",children:"Advanced Scoring"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"AI-powered cryoprotectant analysis"})]}),(0,r.jsxs)(Card,{className:"p-4 text-center",children:[(0,r.jsx)("div",{className:"text-2xl mb-2",children:"\uD83D\uDCCA"}),(0,r.jsx)("h4",{className:"font-semibold mb-1",children:"Rich Properties"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Complete molecular descriptors"})]})]})}),(0,r.jsx)(EnhancedMoleculesList,{})]})}}},function(e){e.O(0,[774,888,179],function(){return e(e.s=451)}),_N_E=e.O()}]);